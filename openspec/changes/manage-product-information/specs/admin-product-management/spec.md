# Admin Product Management Specification

## ADDED Requirements

### Requirement: 管理员商品管理界面
系统 SHALL 为管理员提供商品管理界面，支持查看和编辑商品信息。

#### Scenario: 管理员访问商品管理页面
- **GIVEN** 管理员已通过身份认证
- **WHEN** 管理员访问商品管理页面路径（如 `/admin/products`）
- **THEN** 系统显示商品列表和管理功能，包括：
  - 商品列表（表格或卡片形式）
  - 商品名称、价格（CNY/USD）、库存状态
  - 编辑按钮（每个商品）
  - 刷新按钮

#### Scenario: 管理员查看商品列表
- **GIVEN** 管理员在商品管理页面
- **WHEN** 页面加载或点击刷新按钮
- **THEN** 系统显示所有商品的详细信息：
  - 商品名称
  - 商品描述（截断显示或完整显示）
  - 价格（CNY 和 USD）
  - 当前库存数量
  - 商品状态（在售/售罄）
  - 最后更新时间

### Requirement: 商品价格编辑功能
系统 SHALL 允许管理员编辑商品的 CNY 和 USD 价格。

#### Scenario: 编辑商品价格
- **GIVEN** 管理员在商品管理页面查看商品列表
- **WHEN** 管理员点击某个商品的"编辑"按钮
- **THEN** 系统打开编辑表单，包含：
  - 商品名称（只读显示）
  - CNY 价格输入框
  - USD 价格输入框
  - 保存按钮
  - 取消按钮

#### Scenario: 保存价格修改
- **GIVEN** 管理员正在编辑商品价格表单
- **WHEN** 管理员输入有效的价格数值并点击保存
- **THEN** 系统 SHALL：
  1. 验证价格格式（数字，最多两位小数）
  2. 向后端 API 发送更新请求
  3. 显示成功提示："价格更新成功"
  4. 刷新商品列表显示新价格
  5. 关闭编辑表单

#### Scenario: 价格验证失败
- **GIVEN** 管理员在价格编辑表单中输入无效价格
- **WHEN** 管理员尝试保存
- **THEN** 系统 SHALL：
  - 显示错误提示："价格必须是有效数字，最多两位小数"
  - 不提交表单
  - 保持编辑状态

#### Scenario: 取消价格编辑
- **GIVEN** 管理员正在编辑商品价格表单
- **WHEN** 管理员点击取消按钮
- **THEN** 系统 SHALL：
  - 关闭编辑表单
  - 不保存任何更改
  - 恢复到商品列表视图

### Requirement: 库存信息查看功能
系统 SHALL 显示每个商品的库存信息和状态。

#### Scenario: 查看库存信息
- **GIVEN** 管理员在商品管理页面
- **WHEN** 系统加载商品列表
- **THEN** 每个商品 SHALL 显示：
  - 库存数量（数字显示，如 "150" 或 "0"）
  - 库存状态标签：
    - "库存充足"（数量 > 50）
    - "库存偏低"（数量 10-50）
    - "库存紧张"（数量 1-9）
    - "已售罄"（数量 = 0）

#### Scenario: 库存预警显示
- **GIVEN** 某个商品库存数量低于 10
- **WHEN** 系统显示该商品的库存信息
- **THEN** 库存状态 SHALL 以警告色显示（橙色或红色），并可显示预警图标

#### Scenario: 批量查看库存详情
- **GIVEN** 管理员在商品列表页面
- **WHEN** 管理员需要查看详细库存信息
- **THEN** 系统 SHALL 提供：
  - 点击商品名称可查看更详细的库存信息（入库时间、剩余可售等）
  - 或在库存数量旁显示"查看详情"链接

### Requirement: 管理员权限验证
系统 SHALL 确保只有经过认证的管理员可以访问商品管理功能。

#### Scenario: 未认证用户访问
- **WHEN** 未登录用户尝试访问商品管理页面
- **THEN** 系统 SHALL：
  - 重定向到管理员登录页面
  - 或显示 403 禁止访问错误
  - 不显示任何商品管理内容

#### Scenario: 认证失败处理
- **GIVEN** 用户尝试访问商品管理页面
- **WHEN** 认证令牌无效或已过期
- **THEN** 系统 SHALL：
  - 清除本地认证状态
  - 重定向到登录页面
  - 显示提示："登录已过期，请重新登录"

### Requirement: 响应式设计
商品管理界面 SHALL 在不同设备上正常工作。

#### Scenario: 移动端访问
- **GIVEN** 管理员使用手机浏览器访问商品管理页面
- **WHEN** 页面加载
- **THEN** 系统 SHALL：
  - 以单列布局显示商品列表
  - 折叠编辑表单为模态框
  - 保持所有功能可访问（可能需要滚动）

#### Scenario: 平板访问
- **GIVEN** 管理员使用平板浏览器访问商品管理页面
- **WHEN** 页面加载
- **THEN** 系统 SHALL：
  - 以两列布局显示商品列表
  - 编辑表单适合中等屏幕尺寸

#### Scenario: 桌面端访问
- **GIVEN** 管理员使用桌面浏览器访问商品管理页面
- **WHEN** 页面加载
- **THEN** 系统 SHALL：
  - 以多列网格或表格形式显示商品列表
  - 侧边栏或右侧面板显示编辑表单
  - 充分利用屏幕空间

### Requirement: API 集成
系统 SHALL 与后端 API 集成以获取和更新商品数据。

#### Scenario: 获取商品列表
- **WHEN** 系统需要加载商品列表
- **THEN** 系统 SHALL：
  1. 发送 GET 请求到商品列表 API 端点
  2. 等待响应数据
  3. 加载时显示加载指示器
  4. 成功时渲染商品列表
  5. 失败时显示错误提示和重试按钮

#### Scenario: 更新商品价格
- **WHEN** 管理员保存价格修改
- **THEN** 系统 SHALL：
  1. 发送 PUT/PATCH 请求到商品更新 API 端点
  2. 包含商品 ID 和新价格数据
  3. 等待响应确认
  4. 成功时更新本地数据
  5. 失败时显示错误消息，不更新本地数据

#### Scenario: API 错误处理
- **WHEN** API 请求失败（网络错误、服务器错误等）
- **THEN** 系统 SHALL：
  - 显示通用错误消息："操作失败，请稍后重试"
  - 记录错误信息到控制台
  - 提供重试选项（如果适用）
  - 不关闭编辑表单，允许用户重试
