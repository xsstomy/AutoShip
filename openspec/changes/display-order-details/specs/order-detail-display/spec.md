# order-detail-display Specification

## Purpose
实现用户查看订单详情页面功能，展示订单状态、发货内容和下载链接，为用户提供完整的订单信息查询和商品获取体验。

## ADDED Requirements

### Requirement: 订单详情页面展示
系统 SHALL 提供订单详情页面，用户可以通过URL访问特定订单的完整信息。

#### Scenario: 用户访问订单详情页面
- **GIVEN** 用户有一个有效的订单ID
- **WHEN** 用户访问 `/orders/:orderId` URL
- **THEN** 系统显示订单的基本信息（订单ID、商品名称、价格、邮箱、创建时间）
- **AND** 系统显示订单的当前状态（待支付、已支付、已发货、已取消、已退款）
- **AND** 页面对移动设备友好，信息清晰可读

### Requirement: 订单状态可视化展示
系统 SHALL 通过直观的UI元素展示订单状态，让用户清楚了解订单进度。

#### Scenario: 不同订单状态的视觉呈现
- **GIVEN** 订单有不同的状态值
- **WHEN** 用户查看订单详情页
- **THEN** 当订单状态为"待支付"时，系统显示黄色的状态标签和"等待支付"的提示文字
- **AND** 当订单状态为"已支付"时，系统显示蓝色的状态标签和"支付成功，准备发货"的提示文字
- **AND** 当订单状态为"已发货"时，系统显示绿色的状态标签和"商品已发货"的提示文字
- **AND** 当订单状态为"已取消"或"已退款"时，系统显示灰色的状态标签和相应的说明文字

### Requirement: 发货内容展示功能
系统 SHALL 根据商品类型展示不同的发货内容，支持文本内容和下载文件两种形式。

#### Scenario: 文本内容商品的发货展示
- **GIVEN** 订单已发货且商品类型为文本内容（如激活码、许可证）
- **WHEN** 用户查看订单详情页
- **THEN** 系统在一个可复制的文本框中显示完整内容
- **AND** 提供"一键复制"按钮方便用户复制

#### Scenario: 下载文件商品的发货展示
- **GIVEN** 订单已发货且商品类型为下载文件
- **WHEN** 用户查看订单详情页
- **THEN** 系统显示文件名和文件大小信息
- **AND** 提供明显的下载按钮引导用户下载

### Requirement: 安全下载链接管理
系统 SHALL 提供安全的下载链接机制，防止未授权访问和滥用。

#### Scenario: 下载链接生成和访问
- **GIVEN** 用户点击下载按钮获取数字商品文件
- **WHEN** 系统处理下载请求
- **THEN** 系统生成带签名的临时下载链接（有效期72小时）
- **AND** 系统记录下载次数（最多允许3次）

#### Scenario: 下载链接失效处理
- **GIVEN** 下载链接过期或达到下载次数限制
- **WHEN** 用户尝试使用失效的下载链接
- **THEN** 系统显示"下载链接已失效"的提示
- **AND** 提供"联系客服重新获取"的选项

### Requirement: 错误处理和用户反馈
系统 SHALL 妥善处理各种异常情况，为用户提供有用的反馈信息。

#### Scenario: 订单不存在或访问错误
- **GIVEN** 用户访问不存在的订单ID或格式错误的订单ID
- **WHEN** 系统无法找到对应的订单
- **THEN** 系统显示"订单不存在"的错误页面
- **AND** 提供"返回首页"的链接

#### Scenario: 网络请求失败处理
- **GIVEN** 网络连接问题或服务器错误
- **WHEN** API请求失败
- **THEN** 系统显示"加载失败，请重试"的错误信息
- **AND** 提供"重新加载"按钮

#### Scenario: 权限验证失败
- **GIVEN** 用户尝试访问无权限的订单
- **WHEN** 系统验证用户访问权限
- **THEN** 系统显示"无权访问此订单"的提示信息